import{o as n,c as t,d as e}from"./app.f9a2ae62.js";const s='{"title":"Методы работы с API НЛМК Connect","description":"","frontmatter":{},"headers":[{"level":2,"title":"Аутентификация и токен доступа","slug":"аутентификация-и-токен-доступа"},{"level":3,"title":"Запрос","slug":"запрос"},{"level":3,"title":"Ответ","slug":"ответ"},{"level":2,"title":"Работа с данными НЛМК Connect","slug":"работа-с-данными-нлмк-connect"},{"level":2,"title":"Получение и обработка данных от НЛМК Connect","slug":"поnучение-и-обработка-данных-от-нлмк-connect"}],"relativePath":"api/methods.md","lastUpdated":1671194362213}',a={},o=e('<h1 id="методы-работы-с-api-нлмк-connect"><a class="header-anchor" href="#методы-работы-с-api-нлмк-connect" aria-hidden="true">#</a> Методы работы с API НЛМК Connect</h1><h2 id="аутентификация-и-токен-доступа"><a class="header-anchor" href="#аутентификация-и-токен-доступа" aria-hidden="true">#</a> Аутентификация и токен доступа</h2><p>Для доступа к API НЛМК Connect необходимо пройти проедуру аутентификации и получить токены доступа.</p><p>Для аутентификации используется протокол <a href="https://tools.ietf.org/html/rfc6749" target="_blank" rel="noopener noreferrer">OAuth 2.0 RFC 6749</a>.</p><h3 id="запрос"><a class="header-anchor" href="#запрос" aria-hidden="true">#</a> Запрос</h3><p>Для получения ключа доступа <code>access_token</code> необходимо выполнить <code>POST</code> запрос на адрес <code>https://nlmk.shop/authorizationserver/oauth/token</code></p><p><em>Обязательные параметры</em> (выдаются при подключении к API):</p><ul><li><code>client_id</code></li><li><code>client_secret</code></li><li><code>username</code></li><li><code>password</code></li></ul><p><em>Заголовки запроса</em></p><ul><li>Content-Type: <code>application/x-www-form-urlencoded</code></li><li>Accept: <code>application/json</code></li></ul><p><strong>Пример запроса (curl)</strong></p><div class="language-bash"><pre><code><span class="token function">curl</span> --location --request POST <span class="token string">&#39;https://nlmk.shop/authorizationserver/oauth/token&#39;</span> <span class="token punctuation">\\</span>\n--header <span class="token string">&#39;Content-Type: application/x-www-form-urlencoded&#39;</span> <span class="token punctuation">\\</span>\n--header <span class="token string">&#39;Accept: application/json&#39;</span> <span class="token punctuation">\\</span>\n--data-urlencode <span class="token string">&#39;grant_type=password&#39;</span> <span class="token punctuation">\\</span>\n--data-urlencode <span class="token string">&#39;client_id=client-identificator&#39;</span> <span class="token punctuation">\\</span>\n--data-urlencode <span class="token string">&#39;client_secret=хххххх&#39;</span> <span class="token punctuation">\\</span>\n--data-urlencode <span class="token string">&#39;username=service@user.ru&#39;</span> <span class="token punctuation">\\</span>\n--data-urlencode <span class="token string">&#39;password=хххххх&#39;</span>\n</code></pre></div><h3 id="ответ"><a class="header-anchor" href="#ответ" aria-hidden="true">#</a> Ответ</h3><p>В ответ от API НЛМК Connect вы получите информацию о токене доступа <code>access_token</code> и времени его жизни <code>expires_in</code> (в секундах)</p><p><strong>Пример успешного ответа</strong></p><div class="language-json"><pre><code><span class="token punctuation">{</span>\n    <span class="token property">&quot;access_token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;9260d63b-4b29-423e-948e-xxxxxxxxxxxx&quot;</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;token_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bearer&quot;</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;refresh_token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;32e32660-b267-4385-90c6-xxxxxxxxxxxx&quot;</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;expires_in&quot;</span><span class="token operator">:</span> <span class="token number">86399</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;scope&quot;</span><span class="token operator">:</span> <span class="token string">&quot;openid&quot;</span>\n<span class="token punctuation">}</span>\n</code></pre></div><p>В случае возникновения ошибки в ответе будет код ошибки <code>error</code> и её описание <code>error_description</code></p><p><strong>Пример ответа с ошибкой</strong></p><div class="language-json"><pre><code><span class="token punctuation">{</span>\n    <span class="token property">&quot;error&quot;</span><span class="token operator">:</span> <span class="token string">&quot;invalid_grant&quot;</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;error_description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Bad credentials&quot;</span>\n<span class="token punctuation">}</span>\n</code></pre></div><div class="tip custom-block"><p class="custom-block-title">Примечание</p><p>Во всех возвращаемых данных используется формат json</p></div><h2 id="работа-с-данными-нлмк-connect"><a class="header-anchor" href="#работа-с-данными-нлмк-connect" aria-hidden="true">#</a> Работа с данными НЛМК Connect</h2><p>Во всех методах используется авторизация типа Bearer</p><p>Обязательный заголовок запроса</p><ul><li>Authorization: <code>Bearer &lt;access_token&gt;</code></li></ul><p>Хост API <code>https://connect.nlmk.shop</code></p><div class="tip custom-block"><p class="custom-block-title">Примечание</p><p>Во всех возвращаемых данных используется формат json</p></div><p><strong>Таблица 1 – Типы бизнес-запросов данных через сервис API НЛМК Connect</strong></p><table><thead><tr><th>Метод</th><th>Эндпоинт</th><th>Параметры</th><th>Результат</th></tr></thead><tbody><tr><td>Получить информацию по СК</td><td><code>GET</code> <code>/api/v1/certificates/&lt;qr_code&gt;</code></td><td><code>qr_code</code> - код сертификата</td><td>Данные сертификата качества</td></tr><tr><td>Получить информацию по ЕП</td><td><code>GET</code> <code>/api/v1/certificates/product/&lt;qr_code&gt;</code></td><td><code>qr_code</code> - код продукции</td><td>Данные единицы продукции</td></tr><tr><td>Скачать скан-копию СК</td><td><code>GET</code> <code>/api/v1/certificates/scans/&lt;qr_code&gt;</code></td><td><code>qr_code</code> - код сертификата</td><td>pdf файл</td></tr></tbody></table><div class="tip custom-block"><p class="custom-block-title">Примечание</p><p>В одном запросе может быть указан один qr-код.</p></div><p>Проверить работу и узнать содержимое ответов можно через Postman</p><h2 id="поnучение-и-обработка-данных-от-нлмк-connect"><a class="header-anchor" href="#поnучение-и-обработка-данных-от-нлмк-connect" aria-hidden="true">#</a> Получение и обработка данных от НЛМК Connect</h2><p>НЛМК Connect возвращает в АС покупателя набор данных в соответствии с типом бизнес-запроса (см. Таблицу 1 выше).</p><p>ИС клиента обрабатывает полученные от НЛМК Connect данные согласно описанию перечня передаваемых тегов, приведенном в <a href="https://doc.nlmk.online/Product_API_Data_Specification.xlsx" target="_blank" rel="noopener noreferrer">Приложение 1. Описание перечня передаваемых НЛМК Connect тегов</a> (файл Excel, 59кб.).</p><p>В случае, отсутствия запрашиваемых данных НЛМК Connect возвращает в АС покупателя соответствующее информационное сообщение об ошибке.</p>',34);a.render=function(e,s,a,c,p,r){return n(),t("div",null,[o])};export default a;export{s as __pageData};
